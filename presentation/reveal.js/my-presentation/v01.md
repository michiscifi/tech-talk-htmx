<!-- .slide: data-background-image="my-presentation/back-to-the-future.png" data-background-opacity="0.2" -->

# HTM<span style="color:lime">X</span>

<!-- Zurück in die Zukunft -->

---
<!-- .slide: data-background-image="my-presentation/matrix.jpg" data-background-size="cover" -->

<blockquote>
<p style="color: lime; font-weight: 900">
    In the beginning was the hyperlink, 
    and the hyperlink was with the web, 
    and the hyperlink was the web. <br>
    And it was good
</p>
<figcaption style="font-size: 0.5em">
    Rescuing REST From the API Winter (https://intercoolerjs.org/2016/01/18/rescuing-rest.html)
</figcaption>
</blockquote>

<blockquote style="font-size: 0.4em; color: lime;">
  Ἐν ἀρχῇ ἦν ὁ λόγος, καὶ ὁ λόγος ἦν πρὸς τὸν θεόν, καὶ θεὸς ἦν ὁ λόγος.
  <figcaption>
   --τὸ κατὰ Ἰωάννην εὐαγγέλιον
  </figcaption>
</blockquote>

---
<!-- .slide: data-background-image="my-presentation/tim-berners-lee-www.jpeg" data-background-opacity="0.1" -->
## 1990

Tim Berners-Lee erfindet das 
<span style="color:lime">W</span>orld <span style="color:lime">W</span>ide<span style="color:lime">W</span>eb, 
um sich und seinen Kollegen die Arbeit zu erleichtern

---

<q style="font-size: 0.7em">
<span style="color: lime">Creating the web was really an act of desperation</span>, 
...
Most of the technology involved in the web, 
like the hypertext, like the Internet,
... had all been designed already.
<span style="color: lime">I just had to put them together.</span>
</q>

---
<!-- .slide: data-background-image="my-presentation/unicorn.jpg" data-background-opacity="0.1" -->
## Der Zauber des Hyperlinks

---
<!-- .slide: data-background-image="my-presentation/unicorn.jpg" data-background-opacity="0.1" -->

```html
<a href="https://developer.mozilla.org/de/docs/Web/HTML">
    MDN HTML Docs
</a>
```
---
<!-- .slide: data-background-image="my-presentation/unicorn.jpg" data-background-opacity="0.1" -->


- ein Hyperlink verweist auf eine andere Resource
- diese Resource kann weitere Hyperlinks enthalten

---

## Was ist eine Resource?

<!-- .slide: data-background-image="my-presentation/post-postmen-bicycles-photo-1.jpg" data-background-opacity="0.1" -->

- Daten
- Informationen, wie mit den Daten umgegangen werden kann

---
<!-- .slide: data-background-image="my-presentation/neuroscience.jpg.webp" data-background-opacity="0.1" -->

Man kann sich eine Resource auch vorstellen ...

- als einen Knoten
- mit Daten
- mit Informationen zu seinen Nachbarknoten
- mit Informationen zu sich selbst

---

<!-- .slide: data-background-image="my-presentation/neuron-net.webp" data-background-opacity="0.1" -->

So bilden Knoten ein Netz, <span style="color: lime">ohne zentrale Verwaltung</span> der Knoten

---
<!-- .slide: data-background-image="my-presentation/fallout-nuke.png" data-background-opacity="0.2" data-background-size="cover" -->

Ziel:

<span style="color: lime">fehlertolerantes</span> System

---
## 

<!-- .slide: data-background-image="my-presentation/fielding-dissertation.png" data-background-opacity="0.1" -->

im Jahr 2000

Roy Thomas Fieldings Dissertation

"Architectural Styles and the Design of Network-based Software Architectures" 

---
<!-- .slide: data-background-image="my-presentation/fielding-dissertation.png" data-background-opacity="0.1" -->

<span style="color: lime">Re</span>presentational <span style="color: lime">S</span>tate <span style="color: lime">T</span>ransfer 

_IS_

---
<!-- .slide: data-background-image="my-presentation/fielding-dissertation.png" data-background-opacity="0.1" -->
<quote>
REST components perform actions on a resource by using a representation to capture the
<span style="color:lime">current or intended state</span>  of that resource and transferring that 
representation between components. 
</quote>


---
<!-- .slide: data-background-image="my-presentation/hyper-hyper.jpg" data-background-opacity="0.1" -->

Soweit alles <span style="color:lime">HYPER</span>

---

aber ...

---
<!-- .slide: data-background-image="my-presentation/cat-waiting-window-30.jpg" data-background-size="cover" data-background-opacity="0.3" -->
## page reload

---
<!-- .slide: data-background-image="my-presentation/javascript.jpg" data-background-opacity="0.1" data-background-size="40%" -->
## The rise of JavaScript

--

```html [4|6-8|11|13-23|14|15-18 ]
<html>
<head></head>
<body>
<a href="/part2" id="myLink">part2</a>
<hr>
<div id="target">
    insert stuff here
</div>
<script type="text/javascript">
    window.onload = function () {
        var myLink = document.getElementById("myLink");

        myLink.onclick = function () {
            var xhr = new XMLHttpRequest();
            xhr.onload = function () {
                var target = document.getElementById("target");
                target.innerHTML = this.responseText;
            }

            req.open("GET", "/part2");
            req.send();
            return false;
        }
    }
</script>
</body>
</html>
```

---

- <span style="color: lime">A</span>synchronous =&gt; ohne Reload der Seite
- <span style="color: lime">J</span>avaScript   =&gt; flexible Sprache im Browser     
- <span style="color: lime">A</span>nd 
- <span style="color: lime">X</span>ML          =&gt; modernes Datenaustauschformat



---

## Douglas Crockford (2001)

<!-- .slide: data-background-image="my-presentation/js-the-good-parts.jpg" data-background-opacity="0.1" data-background-size="50%" -->


JSON-Erfinder
- "JavaScript: The Good Parts"
- JSON als Antwort auf XML
- ermöglicht die JavaScript-Frameworks für SPAs


---

##  JavaScript Fat Clients 

_a.k.a. SPAs_

- bessere User Experience
- Datentransport über AJAX und JSON-REST-APIs
- DOM-Manipulation, Reactiveness
- aber auch: doppelte Datenhaltung
- Domainmodelle auf Server *und* Client
- grosse technologische Fortschritte

--- 

_wichtige Neuerungen und Frameworks_

- nodejs, deno, bun
- TypeScript
- Angular, React, Vue, Svelte
- <span style="color: lime">viele</span> Tools

--- 

## der Preis 

<!-- .slide: data-background-image="my-presentation/node-modules-black-hole.jpg" data-background-opacity="0.1" data-background-size="80% 80%" -->

- enorm gewachsene Komplexität
- steile Lernkurve
- viele Hypes

*(was in der Natur der Sache liegt)*

---

## Carson Gross (2020)

<blockquote>
Was, wenn Browser nicht nur links und <code>&lt;form method="POST"&gt;</code> können, 
sondern auch den Rest von REST?
</blockquote>

---

```html   [6-11|7|8|9|10|13-15|3]
<html>
<head>
    <script src="https://unpkg.com/htmx.org@2.0.8"></script>
</head>
<body>
<p 
   hx-trigger="click"
   hx-get="/part2"
   hx-target="#target"
   hx-swap="innerHTML"
>get part2</p>

<div id="target">
    insert stuff here
</div>
</body>
</html>
```


---

*REST am Beispiel einer todo-Resource*

--- 

<style>
.get {
    color: lightgreen;
}
.post {
    color: gold;
}
.put {
    color: deepskyblue;
}
.patch {
    color: violet;
}
.delete {
    color: lightcoral;
}

</style>
<table>

<tr class="get">
<td >GET</td>
<td>/todos</td>
<td>Collection abrufen</td>
</tr>

<tr class="get">
<td >GET</td>
<td>/todos?search=x</td>
<td>Collection filtern</td>
</tr>


<tr class="get">
<td >GET</td>
<td>/todos/:id</td>
<td>Resource abrufen</td>
</tr>


<tr class="post">
<td >POST</td>
<td>/todos [data]</td>
<td>Resource erzeugen</td>
</tr>

<tr class="put">
<td>PUT</td>
<td>/todos/:id [data]</td>
<td>R. komplett ersetzen</td>
</tr>

<tr class="patch">
<td>PATCH</td>
<td>/todos/:id [data]</td>
<td>R. partiell ersetzen</td>
</tr>

<tr class="delete">
<td>DELETE</td>
<td>/todos/:id</td>
<td>Resource löschen</td>
</tr>
</table>

---

demo zeigen

```
cd ~/Projects/tech-talk-htmx/demo-app
npx nodemon app.js
open  http://localhost:3000
```

---

## demo: simple todo app

*collection abrufen*

```curl
GET	/todos
```

---

*verarbeitung im server*

```js
app.get("/todos", function (req, res) {
  res.render("todo", { todoList: todoList });
});
```

---

*collection template: todo-list.ejs*

```html
<ul id="todo-list">
    <% todoList.forEach(item => { %>
        <%- include('todo-item.ejs', {item: item}) %>
    <% }) %>
</ul>
```
---

*item template: todo-item.ejs*

```html [1-16|3|4|1]
<li id="item-<%= item.id %>">
    <button 
            hx-patch="/todos/<%= item.id %>/toggle"
            hx-target="#item-<%= item.id %>">
        <% if (item.completed) { %>
            repeat
        <% } else { %>
            done
        <% } %>
    </button>
    <% if (item.completed) { %>
        <strike><%= item.task %></strike>
    <% } else { %>
        <%= item.task %>
    <% } %>
</li>
```
---

```javascript
app.patch("/todos/:id/toggle", function (req, res) {
    const itemId = req.params.id;
    let item = findItem(todoList, itemId);
    item["completed"] = !item.completed;

    res.render("todo-item", { item: item });
});
```

---

<!-- .slide: data-background-image="my-presentation/matrix.jpg" data-background-size="cover" -->
## Traum 

---
<!-- .slide: data-background-image="my-presentation/matrix.gif" data-background-size="cover" -->

hx-patch, hx-target, hx-trigger ...

sind 

fester Bestandteil der Browser

---
<!-- .slide: data-background-image="my-presentation/back-to-the-future.png" data-background-opacity="0.2" -->
Mein Dank der geneigten Hörerschaft!
